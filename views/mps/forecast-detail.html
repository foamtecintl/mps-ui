{{define "root-style"}}
{{end}}
{{define "root-body"}}
<div id="body"></div>
{{end}} {{define "root-script"}}
<script>
  Ext.onReady(function() {
    var panel = new Ext.Panel({
      renderTo: 'content',
      layout: 'column',
      items: [
        {
          columnWidth: 0.3,
          html: '<div id="dataForecast"></div>'
        }
      ]
    });

    var form = new Ext.FormPanel({
      renderTo: 'dataForecast',
      labelWidth: 75,
      title: 'Forecast Detail',
      frame:true,
      defaults: {width: 200},
      items: [
        {
          xtype: 'textfield',
          fieldLabel: 'Forecast No.',
          name: 'forecastNo',
          allowBlank: false,
          id: 'forecastNo',
          readOnly: true,
          style: 'background: #ecf0f1;'
        },
        {
          xtype: 'textfield',
          fieldLabel: 'Group Name',
          name: 'groupName',
          allowBlank: false,
          id: 'groupName',
          readOnly: true,
          style: 'background: #ecf0f1;'
        },
        {
          xtype: 'textfield',
          fieldLabel: 'Total Part',
          name: 'totalPart',
          allowBlank: false,
          id: 'totalPart',
          readOnly: true,
          style: 'background: #ecf0f1;'
        }
      ],
      buttons: [{
        text: 'Download excel',
        handler: function() {
          // window.location.href = '/mps/createforecast?id={{.id}}&dateT=' + reqData;
        }
      }]
    });

    var myMask = new Ext.LoadMask(Ext.getBody(), {msg:"Please wait..."});
    myMask.show();

    $.ajax({
      type: 'POST',
      headers: {
        'Content-Type': 'application/json; charset=utf-8',
        'Authorization': localStorage.getItem('token')
      },
      dataType: 'json',
      url: '{{.api_url}}/api/mps/findgforecastbyforecastno',
      data: JSON.stringify({'forecastNo': '{{.no}}'}),
      success: function(result) {
        $('#forecastNo').val(result.forecastNo);
        $('#groupName').val(result.groupName);
        $('#totalPart').val(result.totalPart);
        myMask.hide();
      },
      error: function(err) {
        myMask.hide();
        var resErr = err.responseJSON;
        if(resErr.message.indexOf('token fail') >= 0) {
          localStorage.clear();
          window.location.href = '/login';
        }
      }
    });
  });
</script>
{{end}}